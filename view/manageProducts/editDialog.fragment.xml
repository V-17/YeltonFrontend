<core:FragmentDefinition xmlns="sap.m" xmlns:core="sap.ui.core" xmlns:f="sap.ui.layout.form">
    <Dialog showHeader="false" afterClose="productsEditDialog.close">
        <content>
            <IconTabBar id="iconTabBar" expandable="false" select="_onEditDialogSelectTab">
                <items>
                    <IconTabFilter id="tabMain" key="tabMain" text="Товар">
                        <VBox>
                            <Label text="Название" labelFor="inputName"/>
                            <Input
                                id="inputName"
                                value="{/name}"
                                placeholder="Введите название товара"
                                valueStateText="Укажите название товара"
                                maxLength="50"
                                liveChange="_onInputNameLiveChange"/>

                            <Label text="Категория" labelFor="selectCategory" class="sapUiSmallMarginTop"/>
                            <Select id="selectCategory" items="{categories>/}" width="100%" tooltip="Категория">
                                <core:Item key="{categories>id}:{categories>clientID}" text="{categories>name}"/>
                            </Select>

                            <Label text="Мера" labelFor="selectUnit" class="sapUiSmallMarginTop"/>
                            <Select id="selectUnit" items="{units>/}" width="100%" tooltip="Единица измерения">
                                <core:Item key="{units>id}:{units>clientID}" text="{units>fullName}"/>
                            </Select>

                            <Label text="Производитель" labelFor="inputManufacturer" class="sapUiSmallMarginTop"/>
                            <Input id="inputManufacturer" value="{/manufacturer}" placeholder="Производитель товара" maxLength="50"/>

                            <Label text="Штрих-код" labelFor="inputBarcode" class="sapUiSmallMarginTop"/>
                            <HBox>
                                <Input
                                    id="inputBarcode"
                                    value="{/barcode}"
                                    maxLength="255"
                                    width="100%"
                                    liveChange="productsEditDialog.onBarcodeLiveChange"/>
                                <Button
                                    id="buttonBarcodeSearch"
                                    icon="sap-icon://globe"
                                    tooltip="Поиск в интернете"
                                    press="productsEditDialog.searchBarcode"
                                    enabled="false"/>
                            </HBox>
                        </VBox>
                    </IconTabFilter>
                    <IconTabFilter id="tabPrices" text="Цены">
                        <List>
                            <items>
                                <StandardListItem
                                    title="{/minPrice/storeName}"
                                    icon="sap-icon://thumb-up"
                                    info="{/minPrice/price} {/minPrice/currency}/{/minPrice/unitShortName}"
                                    infoState="Success"
                                    tooltip="Минимальная цена"
                                    description="{/minPrice/date}"/>
                                <StandardListItem
                                    title="{/maxPrice/storeName}"
                                    icon="sap-icon://thumb-down"
                                    info="{/maxPrice/price} {/maxPrice/currency}/{/maxPrice/unitShortName}"
                                    infoState="Error"
                                    tooltip="Максимальная цена"
                                    description="{/maxPrice/date}"/>
                            </items>
                        </List>
                    </IconTabFilter>
                    <IconTabFilter id="tabStores" text="Магазины">
                        <Text text="Где и сколько раз данный товар  был куплен"/>
                        <List
                            noDataText="Нет покупок"
                            items="{
                                path: '/stores',
                                sorter: {
                                    path: 'count',
                                    descending: true
                                }
                            }">
                            <StandardListItem
                                title="{name}"
                                counter="{count}"
                                type="Active"
                                press="productsEditDialog.navToPricesFilter"
                                tooltip="Перейти к просмотру истории покупок"/>
                        </List>
                    </IconTabFilter>
                </items>
            </IconTabBar>
        </content>
        <buttons>
            <Button id="buttonDelete" tooltip="Удалить" icon="sap-icon://delete" visible="false" press="productsDeleteDialog.show"/>
            <Button id="buttonEdit" tooltip="Изменить" icon="sap-icon://edit" press="productsEditDialog.edit"/>
            <Button id="buttonSave" text="Сохранить" type="Accept" press="productsEditDialog.save"/>
            <Button text="Закрыть" press="productsEditDialog.close"/>
        </buttons>
    </Dialog>
</core:FragmentDefinition>
